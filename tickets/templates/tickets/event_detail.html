{% extends "tickets/base.html" %}

{% block content %}
<h1 class="mt-5">{{ event.name }}</h1>   
<p>{{ event.date_time|date:"Y-m-d H:i" }} — {{ event.location }}</p>
<p>Satılan bilet: {{ event.tickets_sold }} / {{ event.max_tickets }}</p>
<div class="ticket-list">
    <h2>Satılan Biletler</h2>
    {% for ticket in tickets %}
        {% if forloop.first %}
        <div class="ticket-table-wrapper" style="max-height:300px; overflow-y:auto; border:1px solid #e5e7eb; border-radius:6px;">
            <table class="ticket-table" style="width:100%; border-collapse:collapse;">
                <thead style="position:sticky; top:0; background:#fff; z-index:1;">
                    <tr>
                        <th style="text-align:left; padding:8px 12px; border-bottom:1px solid #e5e7eb;">#</th>
                        <th style="text-align:left; padding:8px 12px; border-bottom:1px solid #e5e7eb;">İsim Soyisim</th>
                        <th style="text-align:left; padding:8px 12px; border-bottom:1px solid #e5e7eb;">+1</th>
                        <th style="text-align:left; padding:8px 12px; border-bottom:1px solid #e5e7eb;">Durum</th>
                        <th style="text-align:left; padding:8px 12px; border-bottom:1px solid #e5e7eb;">Giriş Tarihi</th>
                        <th style="text-align:left; padding:8px 12px; border-bottom:1px solid #e5e7eb;">Satın Alınma Tarihi</th>
                    </tr>
                </thead>
                <tbody>
        {% endif %}
                    <tr>
                        <td style="padding:8px 12px; border-bottom:1px solid #f3f4f6;">{{ ticket.id }}</td>
                        <td style="padding:8px 12px; border-bottom:1px solid #f3f4f6;">{{ ticket.attendee_name }}</td>
                        <td style="padding:8px 12px; border-bottom:1px solid #f3f4f6;">{{ ticket.plus_ones }}</td>
                        <td style="padding:8px 12px; border-bottom:1px solid #f3f4f6;">{{ ticket.get_status_display }}</td>
                        <td style="padding:8px 12px; border-bottom:1px solid #f3f4f6;">{{ ticket.checked_in_at|date:"Y-m-d H:i" }}</td>
                        <td style="padding:8px 12px; border-bottom:1px solid #f3f4f6;">{{ ticket.created_at|date:"Y-m-d H:i" }}</td>
                    </tr>
        {% if forloop.last %}
                </tbody>
            </table>
        </div>
        {% endif %}
    {% empty %}
        <p>Henüz bilet yok.</p>
    {% endfor %}
</div>
{% endblock %}